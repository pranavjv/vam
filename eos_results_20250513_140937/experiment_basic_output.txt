STDOUT:
Using device: cuda
Setting random seed to 42 for model initialization.

Testing with eta=0.001
Adam theoretical AEoS bound: 38000.00
Running Adam experiment...


STDERR:

  0%|          | 0/100 [00:00<?, ?it/s]
  0%|          | 0/100 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/home/pranavaidhya/vam/edge_of_stability_analysis.py", line 480, in <module>
    main() 
  File "/home/pranavaidhya/vam/edge_of_stability_analysis.py", line 470, in main
    analyzer.run_edge_of_stability_experiment(
  File "/home/pranavaidhya/vam/edge_of_stability_analysis.py", line 290, in run_edge_of_stability_experiment
    max_eig = self.compute_max_eigenvalue(model_adam, optimizer_adam)
  File "/home/pranavaidhya/vam/edge_of_stability_analysis.py", line 185, in compute_max_eigenvalue
    Hv = self._hessian_vector_product(model, v, data, target)
  File "/home/pranavaidhya/vam/edge_of_stability_analysis.py", line 222, in _hessian_vector_product
    Hv = torch.cat([h.view(-1) for h in Hv if h is not None])
  File "/home/pranavaidhya/vam/edge_of_stability_analysis.py", line 222, in <listcomp>
    Hv = torch.cat([h.view(-1) for h in Hv if h is not None])
RuntimeError: view size is not compatible with input tensor's size and stride (at least one dimension spans across two contiguous subspaces). Use .reshape(...) instead.


